<div class="content" >
<div ng-controller="tasksCtrl" class="items">
	<h1>Tasks</h1>
	</br>
	<div ng-repeat="task in project.tasks" class="item">
		<table width="400">
			<tr>
				<td colspan="2">
					<h3>Task mark: {{task.mark}}</h3>
				</td>
			</tr>
			<tr>
				<td>
					Title: {{task.title}}
				</td>
			</tr>
			<tr>
				<td >
					Priority: {{task.priority.name}}</td>
			</tr>
			<tr>
				<td >
					Status: {{task.status.name}}</td>
			</tr>
		</table>
		<div style="position:relative; bottom:5px; left: 60%;">
			<button ng-if="getCurrentUserRole()&&getCurrentUserRole()=='admin'" ng-click="delete(task,project)"><img src="images/delete.jpg" width="30"></button>
			<button ng-if="getCurrentUserRole()&&getCurrentUserRole()=='admin'" ng-click="edit(task)"><img src="images/edit.png" width="30"></button>
			<button ng-click="details(task)"><img src="images/details.png" width="30"></button>
		</div>
	</div>

<div  ng-if="isLoggedIn()" class="newItem">
	<hr/>
	<h2>New task</h2>
	<table>  
		<tr>
			<td><input class="form-control input-sm chat-input" type="text" ng-model="task.mark" ng-init="task.mark = project.mark + '-' + project.counter" readonly> 
			</td>
		</tr>
		<tr>
			<td><input class="form-control input-sm chat-input" type="text" ng-model="task.title" placeholder="title"></td>
		</tr>
		<tr><td>
			<ui-select ng-model="task.priority">
    			<ui-select-match>
       			 	<span ng-bind="$select.selected.name"></span>
    			</ui-select-match>
   			 		<ui-select-choices repeat="item in (priority | filter: $select.search) track by item.id">
       					 <span ng-bind="item.name"></span>
    				</ui-select-choices>
			</ui-select>
		</td>
		</tr>

		<tr><td>
			<ui-select ng-model="task.status">
    			<ui-select-match>
       			 	<span ng-bind="$select.selected.name"></span>
    			</ui-select-match>
   			 		<ui-select-choices repeat="item in (status | filter: $select.search) track by item.id">
       					 <span ng-bind="item.name"></span>
    				</ui-select-choices>
			</ui-select>
		</td>
		</tr>
		<tr>
			<td><ui-select ng-model="task.assignedTo">
    			<ui-select-match>
       			 	<span ng-bind="$select.selected"></span>
    			</ui-select-match>
   			 		<ui-select-choices repeat="item in (project.users | filter: $select.search)">
       					 <span ng-bind="item"></span>
    				</ui-select-choices>
			</ui-select>
				<input type="hidden" ng-model="task.createdBy" ng-init="task.createdBy = getCurrentUser()" readonly>
			</td>
		</tr>
		<tr>
			<td><textarea  class="form-control input-sm chat-input" rows="4" cols="50" ng-model="task.entry" placeholder="entry"></textarea></td>
		</tr>
		<tr>
			<td align="right"><br/><button ng-click="save(project)" class="btn btn-primary">submit</button></td>
		</tr>
	</table>
	</div>
	
</div>
</div>